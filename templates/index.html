<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cron√¥metro Gamer</title>

    <!-- Fonte Pixelada -->
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Press Start 2P", monospace;
        background: linear-gradient(135deg, #ff4d4d, #cc0000, #660000);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 15px;
      }

      .container {
        width: 100%;
        max-width: 750px;
        background: #1a0000;
        border: 6px solid #ff1a1a;
        box-shadow: 0 0 20px #ff3333, 0 0 40px #ff0000 inset;
        padding: 20px;
      }

      .header {
        text-align: center;
        color: #fff;
        margin-bottom: 20px;
      }

      .header h1 {
        font-size: 1rem;
        text-shadow: 0 0 8px #ff4d4d, 0 0 15px #ff0000;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 0.6rem;
        color: #ffcccc;
      }

      .controls {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      label {
        font-size: 0.6rem;
        color: #ffcccc;
        margin-bottom: 5px;
      }

      input {
        width: 100%;
        padding: 10px;
        background: #330000;
        border: 3px solid #ff1a1a;
        color: #fff;
        font-size: 0.7rem;
        text-align: center;
        font-family: "Press Start 2P", monospace;
      }

      input:focus {
        outline: none;
        border-color: #ff4d4d;
        box-shadow: 0 0 10px #ff4d4d;
      }

      .row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }

      .button-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 10px;
      }

      button {
        padding: 12px;
        border: none;
        font-size: 0.6rem;
        font-family: "Press Start 2P", monospace;
        cursor: pointer;
        background: #ff1a1a;
        color: #fff;
        box-shadow: 0 0 5px #ff4d4d, inset 0 0 10px #800000;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      button:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px #ff6666, inset 0 0 15px #ff0000;
      }

      .btn-secondary {
        background: #800000;
      }

      .btn-danger {
        background: #b30000;
      }

      .info-card {
        background: #1a0000;
        border: 3px solid #ff1a1a;
        padding: 10px;
        color: #ffcccc;
        text-align: center;
        font-size: 0.6rem;
      }

      .info-card .value {
        color: #fff;
        font-size: 0.7rem;
      }

      .timer-display,
      .countdown-display,
      .rest-display {
        margin-top: 20px;
        padding: 20px;
        border: 4px solid #ff4d4d;
        text-align: center;
        background: #260000;
        display: none;
        color: #fff;
      }

      .timer-display.active,
      .countdown-display.active,
      .rest-display.active {
        display: block;
      }

      .time-numbers,
      .countdown-numbers {
        font-size: clamp(1rem, 6vw, 2rem);
        color: #ff6666;
        margin: 20px 0;
        text-shadow: 0 0 8px #ff1a1a, 0 0 15px #ff0000;
      }

      .phase-indicator {
        margin-top: 10px;
        padding: 8px;
        background: #4d0000;
        border: 3px solid #ff3333;
        font-size: 0.6rem;
        color: #fff;
      }

      .progress-bar {
        width: 100%;
        height: 18px;
        background: #330000;
        border: 3px solid #ff1a1a;
        margin: 15px 0;
      }

      .progress-fill {
        height: 100%;
        width: 0%;
        background: #ff3333;
        transition: width 0.5s ease;
      }

      .stop-section {
        background: #330000;
        border: 3px solid #b30000;
        color: #ffcccc;
        margin-top: 20px;
        padding: 20px;
        display: none;
        text-align: center;
      }

      .stop-section.active {
        display: block;
      }

      .status-message {
        margin-top: 15px;
        text-align: center;
        font-size: 0.6rem;
        color: #fff;
      }

      .status-success {
        color: #00ff66;
      }

      .status-error {
        color: #ff3333;
      }

      @media (max-width: 480px) {
        .container {
          padding: 10px;
        }

        button {
          font-size: 0.5rem;
          padding: 8px;
        }

        .time-numbers,
        .countdown-numbers {
          font-size: 1.2rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üî• Cron√¥metro Gamer üî•</h1>
        <p>Modo Arcade do Tempo</p>
      </div>

      <div class="controls">
        <div>
          <label for="totalTime">Tempo Total (minutos):</label>
          <input type="number" id="totalTime" min="1" value="2" />
        </div>

        <div>
          <label for="interval">Intervalo para Sinal Sonoro (minutos):</label>
          <input type="number" id="interval" min="0" value="1" />
        </div>

        <div class="row">
          <div>
            <label for="rounds">N√∫mero de Rounds:</label>
            <input type="number" id="rounds" min="1" value="3" />
          </div>
          <div>
            <label for="restTime">Tempo de Descanso (segundos):</label>
            <input type="number" id="restTime" min="0" value="10" />
          </div>
        </div>

        <div class="info-card">
          <h4>üìù Configura√ß√£o Atual</h4>
          <div id="configSummary">3 rounds de 40 segundos cada</div>
        </div>

        <div class="button-group">
          <button onclick="startTimer()">‚ñ∂ START</button>
          <button class="btn-secondary" onclick="resetForm()">RESET</button>
        </div>

        <!-- Countdown -->
        <div class="countdown-display" id="countdownDisplay">
          <h3>üéØ Preparando...</h3>
          <div class="countdown-numbers" id="countdownNumbers">10</div>
          <div class="phase-indicator">
            Round <span id="nextRoundNumber">1</span> come√ßando...
          </div>
        </div>

        <!-- Rest -->
        <div class="rest-display" id="restDisplay">
          <h3>‚òï Descanso</h3>
          <div class="countdown-numbers" id="restNumbers">10</div>
          <div class="phase-indicator">
            Round <span id="restRoundNumber">1</span> finalizado
          </div>
        </div>

        <!-- Timer ativo -->
        <div class="timer-display" id="timerDisplay">
          <div class="phase-indicator" id="phaseIndicator">WORK</div>
          <div class="time-numbers" id="timeDisplay">00:00</div>

          <div class="progress-bar">
            <div class="progress-fill" id="roundProgressFill"></div>
          </div>

          <div class="info-card">
            Round <span class="value" id="currentRound">1/3</span>
          </div>
          <div class="info-card">
            Tempo do Round: <span class="value" id="roundTime">00:00</span>
          </div>
          <div class="info-card">
            Progresso Round: <span class="value" id="roundProgress">0%</span>
          </div>
          <div class="info-card">
            Progresso Total: <span class="value" id="totalProgress">0%</span>
          </div>
        </div>

        <!-- Stop -->
        <div class="stop-section" id="stopSection">
          <h3>‚èπ TIMER ATIVO</h3>
          <p>Use o bot√£o abaixo para parar.</p>
          <button class="btn-danger" onclick="stopTimer()">STOP</button>
        </div>

        <!-- Status -->
        <div class="status-message" id="statusMessage"></div>
      </div>
    </div>

    <script>
      let timerInterval, countdownInterval, restInterval;
      let totalSeconds, roundSeconds, restSeconds;
      let rounds, currentRound, intervalMinutes, elapsedTotal;
      let isRunning = false;

      function startTimer() {
        if (isRunning) return;
        isRunning = true;

        totalSeconds =
          parseInt(document.getElementById("totalTime").value) * 60;
        intervalMinutes = parseInt(document.getElementById("interval").value);
        rounds = parseInt(document.getElementById("rounds").value);
        restSeconds = parseInt(document.getElementById("restTime").value);

        roundSeconds = totalSeconds / rounds;
        currentRound = 1;
        elapsedTotal = 0;

        document.getElementById(
          "configSummary"
        ).innerText = `${rounds} rounds de ${Math.round(
          roundSeconds
        )} segundos cada`;

        document.getElementById("countdownDisplay").classList.add("active");
        document.getElementById("stopSection").classList.add("active");
        document.getElementById("statusMessage").innerText = "";

        let countdown = 10;
        document.getElementById("countdownNumbers").innerText = countdown;
        document.getElementById("nextRoundNumber").innerText = currentRound;

        countdownInterval = setInterval(() => {
          countdown--;
          document.getElementById("countdownNumbers").innerText = countdown;
          if (countdown <= 0) {
            clearInterval(countdownInterval);
            document
              .getElementById("countdownDisplay")
              .classList.remove("active");
            runRound();
          }
        }, 1000);
      }

      function runRound() {
        let remaining = roundSeconds;
        updateTimerDisplay(remaining);

        document.getElementById("timerDisplay").classList.add("active");

        timerInterval = setInterval(() => {
          remaining--;
          elapsedTotal++;
          updateTimerDisplay(remaining);

          if (
            intervalMinutes > 0 &&
            elapsedTotal % (intervalMinutes * 60) === 0
          ) {
            playBeep();
          }

          if (remaining <= 0) {
            clearInterval(timerInterval);
            if (currentRound < rounds) {
              runRest();
            } else {
              finishTimer();
            }
          }
        }, 1000);
      }

      function runRest() {
        let remainingRest = restSeconds;
        document.getElementById("timerDisplay").classList.remove("active");
        document.getElementById("restDisplay").classList.add("active");
        document.getElementById("restNumbers").innerText = remainingRest;
        document.getElementById("restRoundNumber").innerText = currentRound;

        restInterval = setInterval(() => {
          remainingRest--;
          document.getElementById("restNumbers").innerText = remainingRest;
          if (remainingRest <= 0) {
            clearInterval(restInterval);
            document.getElementById("restDisplay").classList.remove("active");
            currentRound++;
            runRound();
          }
        }, 1000);
      }

      function updateTimerDisplay(remaining) {
        let minutes = Math.floor(remaining / 60);
        let seconds = remaining % 60;
        document.getElementById("timeDisplay").innerText = `${String(
          minutes
        ).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`;

        document.getElementById(
          "currentRound"
        ).innerText = `${currentRound}/${rounds}`;
        document.getElementById("roundTime").innerText = `${Math.round(
          roundSeconds
        )}s`;
        document.getElementById("roundProgress").innerText = `${Math.round(
          ((roundSeconds - remaining) / roundSeconds) * 100
        )}%`;
        document.getElementById("totalProgress").innerText = `${Math.round(
          (elapsedTotal / totalSeconds) * 100
        )}%`;

        document.getElementById("roundProgressFill").style.width = `${
          ((roundSeconds - remaining) / roundSeconds) * 100
        }%`;
      }

      function stopTimer() {
        clearInterval(timerInterval);
        clearInterval(countdownInterval);
        clearInterval(restInterval);
        isRunning = false;

        document.getElementById("timerDisplay").classList.remove("active");
        document.getElementById("countdownDisplay").classList.remove("active");
        document.getElementById("restDisplay").classList.remove("active");
        document.getElementById("stopSection").classList.remove("active");

        document.getElementById("statusMessage").innerText =
          "‚èπ Timer parado manualmente.";
        document.getElementById("statusMessage").className =
          "status-message status-error";
      }

      function finishTimer() {
        isRunning = false;
        document.getElementById("timerDisplay").classList.remove("active");
        document.getElementById("stopSection").classList.remove("active");

        document.getElementById("statusMessage").innerText =
          "‚úÖ Todos os rounds conclu√≠dos!";
        document.getElementById("statusMessage").className =
          "status-message status-success";
        playBeep(true);
      }

      function resetForm() {
        if (isRunning) stopTimer();
        document.getElementById("totalTime").value = 2;
        document.getElementById("interval").value = 1;
        document.getElementById("rounds").value = 3;
        document.getElementById("restTime").value = 10;
        document.getElementById("configSummary").innerText =
          "3 rounds de 40 segundos cada";
        document.getElementById("statusMessage").innerText = "";
      }

      function playBeep(long = false) {
        let duration = long ? 500 : 200;
        let freq = 1000;
        let ctx = new (window.AudioContext || window.webkitAudioContext)();
        let osc = ctx.createOscillator();
        let gain = ctx.createGain();
        osc.type = "square";
        osc.frequency.value = freq;
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start();
        gain.gain.setValueAtTime(1, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(
          0.0001,
          ctx.currentTime + duration / 1000
        );
        osc.stop(ctx.currentTime + duration / 1000);
      }
    </script>
  </body>
</html>
